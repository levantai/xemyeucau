<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <title>D·ªØ li·ªáu Y√™u C·∫ßu D·ªãch V·ª•</title>

    <!-- Bootstrap -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css">

    <style>
        body {
            background: #f5f6fa;
            padding: 20px;
        }

        table {
            background: #fff;
        }

        thead th {
            background: #3498db;
            color: #fff;
            text-align: center;
        }

        tbody td {
            vertical-align: middle;
        }

        .status-pending {
            color: #d35400;
            font-weight: bold;
        }

        .status-done {
            color: green;
            font-weight: bold;
        }
    </style>
</head>

<body>

    <div class="container">
        <h2 class="text-center mb-4">üìã Danh s√°ch y√™u c·∫ßu d·ªãch v·ª•</h2>

        <div id="loading" class="alert alert-info">‚è≥ ƒêang t·∫£i d·ªØ li·ªáu t·ª´ Google Sheet...</div>

        <table id="dataTable" class="table table-bordered table-striped d-none">
            <thead id="tableHead"></thead>
            <tbody id="tableBody"></tbody>
        </table>
    </div>

    <script>
        // üëâ THAY API JSON C·ª¶A B·∫†N V√ÄO ƒê√ÇY
        const API_URL = "https://script.google.com/macros/s/AKfycbxyz123/exec?mode=json";

        fetch(API_URL)
            .then(res => res.json())
            .then(json => {
                document.getElementById("loading").classList.add("d-none");
                document.getElementById("dataTable").classList.remove("d-none");

                const headers = json.headers;
                const rows = json.data;

                // ======= HEADER =======
                let thHTML = "<tr>";
                headers.forEach(h => {
                    thHTML += `<th>${h}</th>`;
                });
                thHTML += "</tr>";
                document.getElementById("tableHead").innerHTML = thHTML;

                // ======= BODY =======
                let bodyHTML = "";
                rows.forEach(row => {
                    bodyHTML += "<tr>";

                    row.forEach((cell, index) => {
                        let cls = "";
                        if (index === 4) {
                            if (cell === "Ch∆∞a x·ª≠ l√Ω") cls = "status-pending";
                            if (cell === "Ho√†n th√†nh") cls = "status-done";
                        }
                        bodyHTML += `<td class="${cls}">${cell}</td>`;
                    });

                    bodyHTML += "</tr>";
                });

                document.getElementById("tableBody").innerHTML = bodyHTML;
            })
            .catch(err => {
                document.getElementById("loading").classList.remove("alert-info");
                document.getElementById("loading").classList.add("alert-danger");
                document.getElementById("loading").innerHTML = "‚ùå L·ªói t·∫£i d·ªØ li·ªáu: " + err;
            });
    </script>
</body>
</html>

