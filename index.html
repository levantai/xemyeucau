<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Danh Sách Yêu Cầu Dịch Vụ</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
  <link rel="stylesheet" href="https://cdn.datatables.net/2.1.8/css/dataTables.bootstrap5.min.css">
  <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;500;700&display=swap" rel="stylesheet">
  <style>
    body { font-family: 'Roboto', sans-serif; background: #f8f9fa; padding: 20px 0; }
    .container { background: white; border-radius: 12px; box-shadow: 0 4px 20px rgba(0,0,0,0.1); padding: 30px; }
    h1 { color: #2c3e50; text-align: center; margin-bottom: 30px; font-weight: 700; }
    .badge-hoanthanh { background: #d4edda !important; color: #155724 !important; }
    .badge-chuaxuly { background: #fff3cd !important; color: #856404 !important; }
    .table th { background: #0d6efd; color: white; text-align: center; }
    .table td { vertical-align: middle; }
    .dataTables_wrapper .dataTables_length select, .dataTables_wrapper .dataTables_filter input { border-radius: 8px; }
    @media (max-width: 768px) { .container { padding: 15px; } }
  </style>
</head>
<body>
  <div class="container">
    <h1>DANH SÁCH YÊU CẦU DỊCH VỤ / BẢO TRÌ</h1>
    <div class="table-responsive">
      <table id="yeuCauTable" class="table table-striped table-hover table-bordered">
        <thead>
          <tr>
            <th>STT</th>
            <th>Ngày</th>
            <th>Nội dung</th>
            <th>Họ và tên</th>
            <th>Nơi yêu cầu</th>
            <th>Tình trạng</th>
            <th>Ghi chú</th>
          </tr>
        </thead>
        <tbody>
          <? var rowIndex = 1; ?>
          <? for (var i = 0; i < dataRows.length; i++) { ?>
            <? var row = dataRows[i]; ?>
            <tr>
              <td class="text-center"><?= rowIndex++ ?></td>
              <td><?= row[0] ?></td>
              <td><strong><?= row[1] ?></strong></td>
              <td><?= row[2] ?></td>
              <td><?= row[3] ?></td>
              <td class="text-center">
                <? if (row[4] === "Hoàn thành") { ?>
                  <span class="badge bg-success badge-hoanthanh fs-6">Hoàn thành</span>
                <? } else { ?>
                  <span class="badge bg-warning badge-chuaxuly fs-6">Chưa xử lý</span>
                <? } ?>
              </td>
              <td><?= row[5] || "-" ?></td>
            </tr>
          <? } ?>
        </tbody>
      </table>
    </div>
    <div class="text-center mt-4">
      <p class="text-muted">Cập nhật lúc: <?= new Date().toLocaleString('vi-VN') ?></p>
      <a href="<?= SpreadsheetApp.getActiveSpreadsheet().getUrl() ?>" target="_blank" class="btn btn-primary">Mở Google Sheet</a>
    </div>
  </div>

  <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
  <script src="https://cdn.datatables.net/2.1.8/js/dataTables.min.js"></script>
  <script src="https://cdn.datatables.net/2.1.8/js/dataTables.bootstrap5.min.js"></script>
  <script>
    $(document).ready(function() {
      $('#yeuCauTable').DataTable({
        language: { url: 'https://cdn.datatables.net/plug-ins/1.13.7/i18n/vi.json' },
        pageLength: 10,
        lengthMenu: [10, 25, 50, 100],
        order: [[0, 'desc']],
        columnDefs: [{ orderable: false, targets: 6 }, { className: "text-center", targets: [0, 5] }]
      });
    });
  </script>
</body>
</html>
