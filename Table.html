<!DOCTYPE html>
<html>
  <head>
    <base target="_top">

    <style>
      body {
        font-family: Arial, sans-serif;
        padding: 20px;
        background: #f5f6fa;
      }

      h2 {
        text-align: center;
        margin-bottom: 20px;
        color: #2c3e50;
      }

      table {
        width: 100%;
        border-collapse: collapse;
        margin-top: 10px;
        background: white;
      }

      th {
        background: #3498db;
        color: white;
        padding: 10px;
        text-align: left;
      }

      td {
        padding: 8px;
        border-bottom: 1px solid #ddd;
      }

      tr:hover {
        background: #f0f8ff;
      }

      .status-pending {
        color: #d35400;
        font-weight: bold;
      }

      .status-done {
        color: green;
        font-weight: bold;
      }

    </style>
  </head>

  <body>

    <h2>Dữ liệu yêu cầu dịch vụ</h2>

    <table>
      <thead>
        <tr>
          <? for (let i = 0; i < headers.length; i++) { ?>
            <th><?= headers[i] ?></th>
          <? } ?>
        </tr>
      </thead>

      <tbody>
        <? for (let r = 0; r < dataRows.length; r++) { ?>
          <tr>
            <? for (let c = 0; c < dataRows[r].length; c++) { ?>
              <? 
                let cell = dataRows[r][c];
                let css = "";
                
                // Tô màu cột "Tình trạng"
                if (c === 4) {
                  if (cell === "Chưa xử lý") css = "status-pending";
                  if (cell === "Hoàn thành") css = "status-done";
                }
              ?>
              <td class="<?= css ?>"><?= cell ?></td>
            <? } ?>
          </tr>
        <? } ?>
      </tbody>
    </table>

  </body>
</html>
